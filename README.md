# FX-DB-UPDATER

Cloud –ø–∞—Ä—Å–µ—Ä –¥–ª—è Telegram-–∫–∞–Ω–∞–ª—ñ–≤ –≤–∞–ª—é—Ç–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
FX-DB-UPDATER/
‚îú‚îÄ‚îÄ parse_all_channels.py       # Launcher –¥–ª—è –≤—Å—ñ—Ö –ø–∞—Ä—Å–µ—Ä—ñ–≤
‚îú‚îÄ‚îÄ supabase_io.py              # –£–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –º–æ–¥—É–ª—å –¥–ª—è Supabase
‚îú‚îÄ‚îÄ fx_parse_SWAPS_cloud.py     # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É SWAPS
‚îú‚îÄ‚îÄ fx_parse_GARANT_cloud.py    # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É GARANT
‚îú‚îÄ‚îÄ fx_parse_MIRVALUTY_cloud.py # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É MIRVALUTY
‚îú‚îÄ‚îÄ fx_parse_KIT_GROUP_cloud.py # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É KIT_GROUP
‚îú‚îÄ‚îÄ fx_parse_CHANGE_KYIV_cloud.py # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É CHANGE_KYIV
‚îú‚îÄ‚îÄ fx_parse_VALUTA_KIEV_cloud.py # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É VALUTA_KIEV
‚îú‚îÄ‚îÄ fx_parse_UACOIN_cloud.py    # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É UACOIN
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îî‚îÄ‚îÄ .env                        # –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è (–Ω–µ –≤ Git!)
```

## üöÄ –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Supabase

–°—Ç–≤–æ—Ä–∏ `.env` —Ñ–∞–π–ª:

```env
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_service_role_key
```

### 2. –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ

–î–ª—è –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª—É:
```bash
python fx_parse_SWAPS_cloud.py
```

–î–ª—è –≤—Å—ñ—Ö –∫–∞–Ω–∞–ª—ñ–≤:
```bash
python parse_all_channels.py
```

### 3. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Render

**Cron Job (–∫–æ–∂–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω)**

1. –í—ñ–¥–∫—Ä–∏–π https://dashboard.render.com
2. –ù–∞—Ç–∏—Å–Ω–∏ "New +" ‚Üí **"Cron Job"**
3. –ü—ñ–¥–∫–ª—é—á–∏ GitHub —Ä–µ–ø–æ: **kulishdenis-Tech/FX-DB-UPDATER**
4. –ù–∞–ª–∞—à—Ç—É–π:
   - **Name**: `fx-parser-all-channels`
   - **Schedule**: `*/10 * * * *` (–∫–æ–∂–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω)
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `python parse_all_channels.py`
5. –î–æ–¥–∞–π Environment Variables (Supabase Dashboard ‚Üí Settings ‚Üí API):
   - `SUPABASE_URL` = `https://xxxxx.supabase.co`
   - `SUPABASE_KEY` = `service_role_key` (–Ω–µ anon key!)
   - `RAW_BUCKET` = `raw` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
6. –ù–∞—Ç–∏—Å–Ω–∏ "Create Cron Job"

**‚ÑπÔ∏è Launcher –∑–∞–ø—É—Å–∫–∞—î –≤—Å—ñ 7 –ø–∞—Ä—Å–µ—Ä—ñ–≤ –ø–æ —á–µ—Ä–∑—ñ!** –Ø–∫—â–æ –æ–¥–∏–Ω –ø–∞–¥–∞—î, —Ä–µ—à—Ç–∞ –ø—Ä–æ–¥–æ–≤–∂—É—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.

### 4. –û—á–∏—â–µ–Ω–Ω—è –ë–î –ø–µ—Ä–µ–¥ –ø–µ—Ä—à–∏–º –∑–∞–ø—É—Å–∫–æ–º

‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–û:** –Ø–∫—â–æ —É —Ç–µ–±–µ –≤–∂–µ —î –¥–∞–Ω—ñ –≤ —Ç–∞–±–ª–∏—Ü—ñ `rates`, **truncate** —Ç–∞–±–ª–∏—Ü—é –ø–µ—Ä–µ–¥ –ø–µ—Ä—à–∏–º –∑–∞–ø—É—Å–∫–æ–º:

```sql
-- –í–∏–∫–æ–Ω–∞–π –≤ Supabase SQL Editor
TRUNCATE TABLE rates RESTART IDENTITY CASCADE;
```

–ì–æ—Ç–æ–≤–∏–π SQL-—Å–∫—Ä–∏–ø—Ç: `truncate_rates.sql`

### 5. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ë–î (–ù–ï –ü–û–¢–†–Ü–ë–ù–û!)

‚úÖ **–£–ù–Ü–ö–ê–õ–¨–ù–Ü –Ü–ù–î–ï–ö–°–ò –í–ò–î–ê–õ–ï–ù–Ü!** –ü–∞—Ä—Å–µ—Ä —Å–∞–º —Ñ—ñ–ª—å—Ç—Ä—É—î –¥—É–±–ª—ñ–∫–∞—Ç–∏ –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ—é.

**–õ–æ–≥—ñ–∫–∞ –∞–Ω—Ç–∏–¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤:**
- –ü–∞—Ä—Å–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑ –ë–î **–≤—Å—ñ —ñ—Å–Ω—É—é—á—ñ –∑–∞–ø–∏—Å–∏** (–ø–∞–≥—ñ–Ω–∞—Ü—ñ—è 1000 –∑–∞–ø–∏—Å—ñ–≤ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É)
- –ü–æ—Ä—ñ–≤–Ω—é—î **–ø–µ—Ä–µ–¥** –≤—Å—Ç–∞–≤–∫–æ—é –∑–∞ –∫–ª—é—á–µ–º: `(message_id, version, currency_a, currency_b, buy, sell, edited, comment)`
- –í—Å—Ç–∞–≤–ª—è—î —Ç—ñ–ª—å–∫–∏ **–Ω–æ–≤—ñ** –∑–∞–ø–∏—Å–∏
- –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ‚Üí –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é
- –†—ñ–∑–Ω—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ (`–≤—ñ–¥ 1000`, `–≤—ñ–¥ 3000`) –≤–≤–∞–∂–∞—é—Ç—å—Å—è **—Ä—ñ–∑–Ω–∏–º–∏** –∑–∞–ø–∏—Å–∞–º–∏

## üß† –õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞

**–ê–Ω—Ç–∏–¥—É–±–ª—ñ–∫–∞—Ç–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ –ë–î:**
- ‚úÖ –ü–∞—Ä—Å–∏—Ç—å **–≤—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** –∑ RAW —Ñ–∞–π–ª—É
- ‚úÖ –ó–∞–ø–∏—Å—É—î **–≤—Å—ñ –≤–µ—Ä—Å—ñ—ó —Ä–µ–¥–∞–≥—É–≤–∞–Ω—å**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ñ—ñ–ª—å—Ç—Ä—É—î** –¥—É–±–ª—ñ–∫–∞—Ç–∏ –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ—é
- ‚úÖ –ü–æ–≤–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É

**–ö–ª—é—á —É–Ω—ñ–∫–∞–ª—å–Ω–æ—Å—Ç—ñ:** `(channel_id, message_id, version, currency_a, currency_b, buy, sell, edited, comment)`

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:**
- **–ö—Ä–æ—Å-–∫—É—Ä—Å–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—é—Ç—å—Å—è: USD –∑–∞–≤–∂–¥–∏ –¥—Ä—É–≥–∏–º (EUR/USD, GBP/USD)
- **–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ** –æ—á–∏—â–∞—é—Ç—å—Å—è: –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è —Å–∏–º–≤–æ–ª–∏ –≤–∞–ª—é—Ç ($, ‚Ç¨) —Ç–∞ –∑–∞–π–≤—ñ —Å–ª–æ–≤–∞
- **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤ –º–æ–±—ñ–ª—å–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É (Flutter)** –Ω–∞ —Ä—ñ–≤–Ω—ñ UI

## üìä –©–æ —Ä–æ–±–∏—Ç—å –ø–∞—Ä—Å–µ—Ä

1. ‚úÖ –ß–∏—Ç–∞—î RAW –¥–∞–Ω—ñ –∑ Supabase Storage (`*_raw.txt`)
2. ‚úÖ –ü–∞—Ä—Å–∏—Ç—å –∫—É—Ä—Å–∏ –≤–∞–ª—é—Ç (USD, EUR, PLN —Ç–æ—â–æ) –¥–ª—è **7 –∫–∞–Ω–∞–ª—ñ–≤**
3. ‚úÖ –í–∏—Ç—è–≥—É—î –º–µ—Ç–∞–¥–∞–Ω—ñ (message_id, version, published, edited)
4. ‚úÖ –§—ñ–ª—å—Ç—Ä—É—î –¥—É–±–ª—ñ–∫–∞—Ç–∏ **–ø–µ—Ä–µ–¥** –≤—Å—Ç–∞–≤–∫–æ—é
5. ‚úÖ –ó–∞–ø–∏—Å—É—î **—Ç—ñ–ª—å–∫–∏ –Ω–æ–≤—ñ** –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—é `rates` —É Supabase

## üîß –†–æ–∑—Ä–æ–±–∫–∞

–ü–∞—Ä—Å–µ—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **100% —ñ–¥–µ–Ω—Ç–∏—á–Ω—É –ª–æ–≥—ñ–∫—É** —â–æ –π –ª–æ–∫–∞–ª—å–Ω—ñ –≤–µ—Ä—Å—ñ—ó, –∞–ª–µ:
- –ß–∏—Ç–∞—é—Ç—å –∑ **Supabase Storage** –∑–∞–º—ñ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
- –ó–∞–ø–∏—Å—É—é—Ç—å –≤ **Supabase DB** (–±–µ–∑ CSV)
- **–ê–Ω—Ç–∏–¥—É–±–ª—ñ–∫–∞—Ç–∏** –Ω–∞ —Ä—ñ–≤–Ω—ñ Python (–ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ—é)

## üìù –õ–æ–≥–∏

```
======================================================================
üöÄ –ó–ê–ü–£–°–ö –£–°–Ü–• –ü–ê–†–°–ï–†–Ü–í (CLOUD)
======================================================================

[RUN] SWAPS...
[CLOUD] ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ Supabase
[CLOUD] ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ 102048 —Å–∏–º–≤–æ–ª—ñ–≤ –∑ Supabase
[PARSED] –ó–Ω–∞–π–¥–µ–Ω–æ: 330 –∫—É—Ä—Å—ñ–≤
  ‚Üí UAH –ø–∞—Ä: 264 | –ö—Ä–æ—Å-–∫—É—Ä—Å—ñ–≤: 66
[CLOUD] ‚úÖ –ó–∞–ø–∏—Å–∞–Ω–æ –≤ –ë–î: 0 –Ω–æ–≤–∏—Ö
[CLOUD] ‚ö†Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤: 330
[DONE] ‚úÖ –ì–æ—Ç–æ–≤–æ.

[RUN] GARANT...
[CLOUD] ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ Supabase
[PARSED] –ó–Ω–∞–π–¥–µ–Ω–æ: 127 –∫—É—Ä—Å—ñ–≤
[CLOUD] ‚úÖ –ó–∞–ø–∏—Å–∞–Ω–æ –≤ –ë–î: 5 –Ω–æ–≤–∏—Ö
[DONE] ‚úÖ –ì–æ—Ç–æ–≤–æ.

...

======================================================================
‚úÖ –£—Å—ñ –ø–∞—Ä—Å–µ—Ä–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Ä–æ–±–æ—Ç—É
======================================================================
```
