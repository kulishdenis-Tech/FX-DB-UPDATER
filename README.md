# FX-DB-UPDATER

Cloud –ø–∞—Ä—Å–µ—Ä –¥–ª—è Telegram-–∫–∞–Ω–∞–ª—ñ–≤ –≤–∞–ª—é—Ç–Ω–∏—Ö –∫—É—Ä—Å—ñ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
FX-DB-UPDATER/
‚îú‚îÄ‚îÄ supabase_io.py              # –£–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –º–æ–¥—É–ª—å –¥–ª—è Supabase
‚îú‚îÄ‚îÄ fx_parse_SWAPS_auto.py      # –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∫–∞–Ω–∞–ª—É SWAPS
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ FIX_SUPABASE.md            # ‚ö†Ô∏è –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ë–î
‚îú‚îÄ‚îÄ fix_supabase_constraint.sql # SQL —Å–∫—Ä–∏–ø—Ç
‚îî‚îÄ‚îÄ .env                        # –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è (–Ω–µ –≤ Git!)
```

## üöÄ –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Supabase

–°—Ç–≤–æ—Ä–∏ `.env` —Ñ–∞–π–ª:

```env
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_service_role_key
```

### 2. –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
python fx_parse_SWAPS_auto.py
```

### 3. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Render

**Cron Job (–∫–æ–∂–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω)**

1. –í—ñ–¥–∫—Ä–∏–π https://dashboard.render.com
2. –ù–∞—Ç–∏—Å–Ω–∏ "New +" ‚Üí **"Cron Job"**
3. –ü—ñ–¥–∫–ª—é—á–∏ GitHub —Ä–µ–ø–æ: **kulishdenis-Tech/FX-DB-UPDATER**
4. –ù–∞–ª–∞—à—Ç—É–π:
   - **Name**: `fx-parser-swaps`
   - **Schedule**: `*/10 * * * *` (–∫–æ–∂–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω)
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `python fx_parse_SWAPS_auto.py`
5. –î–æ–¥–∞–π Environment Variables (Supabase Dashboard ‚Üí Settings ‚Üí API):
   - `SUPABASE_URL` = `https://xxxxx.supabase.co`
   - `SUPABASE_KEY` = `service_role_key` (–Ω–µ anon key!)
6. –ù–∞—Ç–∏—Å–Ω–∏ "Create Cron Job"

**‚ö†Ô∏è –£–≤–∞–≥–∞:** –Ø–∫—â–æ —É —Ç–µ–±–µ –≤–∂–µ —î Background Worker **FX-DB-UPDATER**, –≤–∏–¥–∞–ª–∏ –π–æ–≥–æ –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º Cron Job!

### 4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ë–î (–û–î–ò–ù –†–ê–ó)

‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–û!** –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø–∞—Ä—Å–µ—Ä–∞ –≤–∏–∫–æ–Ω–∞–π —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑ `FIX_SUPABASE.md`!

–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–¥–∞–ª–∏—Ç–∏ UNIQUE INDEX –∑ —Ç–∞–±–ª–∏—Ü—ñ `rates`, —â–æ–± –ø–∞—Ä—Å–µ—Ä –º—ñ–≥ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ **–í–°–ï**.

## üß† –õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞

–ü–∞—Ä—Å–µ—Ä –∑–∞–ø–∏—Å—É—î **–í–°–ï** –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤:
- ‚úÖ –ü–∞—Ä—Å–∏—Ç—å **–≤—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** –∑ RAW —Ñ–∞–π–ª—É
- ‚úÖ –ó–∞–ø–∏—Å—É—î **–≤—Å—ñ –≤–µ—Ä—Å—ñ—ó —Ä–µ–¥–∞–≥—É–≤–∞–Ω—å**
- ‚úÖ **–ù–ï —Ñ—ñ–ª—å—Ç—Ä—É—î** –¥—É–±–ª—ñ–∫–∞—Ç–∏
- ‚úÖ –ü–æ–≤–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É

**–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤ –º–æ–±—ñ–ª—å–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É (Flutter)** –Ω–∞ —Ä—ñ–≤–Ω—ñ UI.

## üìä –©–æ —Ä–æ–±–∏—Ç—å –ø–∞—Ä—Å–µ—Ä

1. ‚úÖ –ß–∏—Ç–∞—î RAW –¥–∞–Ω—ñ –∑ Supabase Storage (`SWAPS_raw.txt`)
2. ‚úÖ –ü–∞—Ä—Å–∏—Ç—å –∫—É—Ä—Å–∏ –≤–∞–ª—é—Ç (USD, EUR, PLN —Ç–æ—â–æ)
3. ‚úÖ –í–∏—Ç—è–≥—É—î –º–µ—Ç–∞–¥–∞–Ω—ñ (message_id, version, published, edited)
4. ‚úÖ –ó–∞–ø–∏—Å—É—î **–í–°–ï** –≤ —Ç–∞–±–ª–∏—Ü—é `rates` —É Supabase

## üîß –†–æ–∑—Ä–æ–±–∫–∞

–ü–∞—Ä—Å–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **—Ç—ñ —Å–∞–º—ñ —Ä–µ–≥—É–ª—è—Ä–∫–∏** —â–æ –π –ª–æ–∫–∞–ª—å–Ω–∞ –≤–µ—Ä—Å—ñ—è, –∞–ª–µ:
- –ß–∏—Ç–∞—î –∑ **Supabase Storage** –∑–∞–º—ñ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
- –ó–∞–ø–∏—Å—É—î –≤ **Supabase DB** (–±–µ–∑ CSV)
- **–ë–ï–ó —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó** - –ø–æ–≤–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è

## üìù –õ–æ–≥–∏

```
[CLOUD] ‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ –¥–æ Supabase
[CLOUD] ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ 102048 —Å–∏–º–≤–æ–ª—ñ–≤ –∑ Supabase
[PARSED] –ó–Ω–∞–π–¥–µ–Ω–æ: 330 –∫—É—Ä—Å—ñ–≤
  ‚Üí UAH –ø–∞—Ä: 264 | –ö—Ä–æ—Å-–∫—É—Ä—Å—ñ–≤: 66
[CLOUD] ‚úÖ –ó–∞–ø–∏—Å–∞–Ω–æ –≤ –ë–î: 330 —Ä—è–¥–∫—ñ–≤
[DONE] ‚úÖ –ì–æ—Ç–æ–≤–æ.
```
